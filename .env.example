# =============================================================================
# Claude Assistant Platform - Environment Configuration
# =============================================================================
# Copy this file to .env and fill in your values
# NEVER commit .env to version control
# =============================================================================

# -----------------------------------------------------------------------------
# Application Settings
# -----------------------------------------------------------------------------
APP_NAME=claude-assistant-platform
APP_ENV=development
DEBUG=true
LOG_LEVEL=INFO

# API Settings (localhost only for development)
API_HOST=0.0.0.0
API_PORT=8000
ALLOWED_HOSTS=localhost,127.0.0.1

# -----------------------------------------------------------------------------
# Anthropic API (Required)
# -----------------------------------------------------------------------------
# Get your API key from: https://console.anthropic.com/
ANTHROPIC_API_KEY=your-anthropic-api-key-here

# Model configuration
CLAUDE_MODEL=claude-sonnet-4-20250514

# -----------------------------------------------------------------------------
# Database (PostgreSQL)
# -----------------------------------------------------------------------------
POSTGRES_DB=claude_assistant_platform
POSTGRES_USER=postgres
POSTGRES_PASSWORD=your-secure-password-here
POSTGRES_HOST=db
POSTGRES_PORT=5432

# Constructed database URL (used by SQLAlchemy)
# DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}

# -----------------------------------------------------------------------------
# Telegram Bot Configuration
# -----------------------------------------------------------------------------
# This platform supports separate development and production bots to prevent
# conflicts when running locally while a production instance is deployed.
#
# How it works:
#   - TELEGRAM_BOT_TOKEN: Production bot (used when APP_ENV=production/staging)
#   - TELEGRAM_DEV_BOT_TOKEN: Development bot (used when APP_ENV=development)
#   - In development mode, if DEV token is set, it takes precedence
#   - In production mode, only the production token is used
#
# Creating a bot via @BotFather:
#   1. Open Telegram and search for @BotFather
#   2. Send /newbot and follow the prompts
#   3. Copy the bot token provided
#
# Recommended setup:
#   - Create TWO bots: one for prod (e.g., "MyAssistant") and one for dev
#     (e.g., "MyAssistantDev")
#   - Use the dev bot for local development to avoid polling conflicts

# Production bot token (required for deployed instances)
TELEGRAM_BOT_TOKEN=your-production-bot-token-here

# Development bot token (optional, for local development)
# When APP_ENV=development and this is set, this bot will be used instead
# This prevents your local instance from conflicting with the production bot
TELEGRAM_DEV_BOT_TOKEN=your-dev-bot-token-here

# Comma-separated list of allowed Telegram user IDs
# Only users in this list can interact with the bot
# To get your user ID:
#   1. Open Telegram and search for @userinfobot
#   2. Send /start to get your user ID
TELEGRAM_ALLOWED_USER_IDS=123456789,987654321

# Long-polling timeout in seconds (default: 30)
# Higher values reduce API calls but increase latency for shutdown
TELEGRAM_POLLING_TIMEOUT=30

# Enable/disable Telegram integration (default: true)
# Set to false to disable Telegram even if bot token is configured
TELEGRAM_ENABLED=true

# -----------------------------------------------------------------------------
# Telegram MCP Server (internal Docker network - do not change)
# -----------------------------------------------------------------------------
TELEGRAM_MCP_HOST=telegram-mcp
TELEGRAM_MCP_PORT=8080

# -----------------------------------------------------------------------------
# Motion Integration
# -----------------------------------------------------------------------------
# Motion is an AI-powered calendar and task management app.
# Get your API key from: https://app.usemotion.com/web/settings/api
#
# CRITICAL: Motion has strict rate limits:
#   - Individual accounts: 12 requests per minute
#   - Team accounts: 120 requests per minute
# Exceeding these limits can result in account suspension!

# Your Motion API key (required for Motion integration)
MOTION_API_KEY=your-motion-api-key-here

# Account type for rate limiting (individual, team, or enterprise)
MOTION_ACCOUNT_TYPE=individual

# Enable/disable Motion integration (default: true)
MOTION_ENABLED=true

# Rate limit override (0 = use default based on account type)
# WARNING: Setting this higher than your account allows WILL get you banned!
MOTION_RATE_LIMIT_OVERRIDE=0

# Rate limit window in seconds (default: 60)
MOTION_RATE_LIMIT_WINDOW=60

# Motion MCP Server (internal Docker network - do not change)
MOTION_MCP_HOST=motion-mcp
MOTION_MCP_PORT=8081

# -----------------------------------------------------------------------------
# Todo Executor Settings
# -----------------------------------------------------------------------------
# Interval in seconds between checking for pending todos (default: 30)
TODO_EXECUTOR_INTERVAL=30

# Maximum todos to process per execution cycle (default: 5)
TODO_EXECUTOR_BATCH_SIZE=5

# Enable/disable background todo executor (default: true)
TODO_EXECUTOR_ENABLED=true

# -----------------------------------------------------------------------------
# Redis Cache Settings
# -----------------------------------------------------------------------------
# Redis is used for caching routing decisions and embeddings
# Redis runs on the Home-Network shared infrastructure (Orange Pi)
# Each application uses a different REDIS_DB number:
#   - DB 0: Claude Assistant Platform
#   - DB 1-15: Available for other apps
REDIS_HOST=192.168.50.35
REDIS_PORT=6379
REDIS_DB=0
# REDIS_PASSWORD=  # Optional, leave empty for no password

# -----------------------------------------------------------------------------
# Hybrid Router Settings
# -----------------------------------------------------------------------------
# The router provides fast agent selection without full LLM calls
# Uses a 3-tier approach: Regex -> BM25+Embedding -> LLM fallback

# Enable/disable the hybrid router (default: true)
ROUTER_ENABLED=true

# Use only Tier 1 (regex) routing - skip Tier 2/3 (default: false)
# Useful for testing or when embeddings aren't configured
ROUTER_TIER1_ONLY=false

# Confidence threshold for bypassing orchestrator LLM (default: 0.75)
# Higher values require more certainty before direct routing
ROUTER_CONFIDENCE_THRESHOLD=0.75

# OpenAI API Key for embedding generation (Phase 2)
# Get your API key from: https://platform.openai.com/api-keys
# Required for Tier 2 (embedding similarity) routing
OPENAI_API_KEY=your-openai-api-key-here

# -----------------------------------------------------------------------------
# MCP Servers
# -----------------------------------------------------------------------------
# GitHub Personal Access Token
# GITHUB_TOKEN=your-github-pat-here

# -----------------------------------------------------------------------------
# Google Calendar MCP Server
# -----------------------------------------------------------------------------
# OAuth credentials from Google Cloud Console
# Setup steps:
#   1. Go to https://console.cloud.google.com/
#   2. Create a project or select existing
#   3. Enable the Google Calendar API
#   4. Go to APIs & Services > Credentials
#   5. Create OAuth 2.0 Client ID (Desktop application type)
#   6. Copy the client ID and secret below
GOOGLE_CALENDAR_CLIENT_ID=your-google-client-id
GOOGLE_CALENDAR_CLIENT_SECRET=your-google-client-secret

# Default timezone for events (IANA format)
GOOGLE_CALENDAR_DEFAULT_TIMEZONE=America/New_York

# Enable/disable Google Calendar integration (default: true)
GOOGLE_CALENDAR_ENABLED=true

# Google Calendar MCP Server (internal Docker network - do not change for Docker)
GOOGLE_CALENDAR_MCP_HOST=google-calendar-mcp
GOOGLE_CALENDAR_MCP_PORT=8084

# Refresh token for containerized/headless deployments
# To get this token:
#   1. Run the MCP server locally (make run)
#   2. Complete OAuth in your browser
#   3. Copy the refresh_token from data/google_calendar_token.json
#   4. Paste it here (or add to Jenkins secrets as 'google-calendar-refresh-token')
GOOGLE_CALENDAR_REFRESH_TOKEN=

# -----------------------------------------------------------------------------
# Gmail MCP Server
# -----------------------------------------------------------------------------
# OAuth credentials from Google Cloud Console
# Can use same project as Google Calendar - just enable Gmail API and add scopes
# Setup steps:
#   1. Use same Google Cloud project as Calendar (or create new)
#   2. Enable the Gmail API
#   3. Add gmail.modify scope to OAuth consent screen
#   4. Use same or separate OAuth credentials
GMAIL_CLIENT_ID=your-google-client-id
GMAIL_CLIENT_SECRET=your-google-client-secret

# Enable/disable Gmail integration (default: true)
GMAIL_ENABLED=true

# Gmail MCP Server (internal Docker network - do not change for Docker)
GMAIL_MCP_HOST=gmail-mcp
GMAIL_MCP_PORT=8085

# Refresh token for containerized/headless deployments
# To get this token:
#   1. Run the MCP server locally (make run)
#   2. Complete OAuth in your browser
#   3. Copy the refresh_token from data/gmail_token.json
#   4. Paste it here (or add to Jenkins secrets as 'gmail-refresh-token')
GMAIL_REFRESH_TOKEN=

# Email Configuration (legacy SMTP - not used by Gmail MCP)
# EMAIL_HOST=smtp.gmail.com
# EMAIL_PORT=587
# EMAIL_USER=your-email@gmail.com
# EMAIL_PASSWORD=your-app-password-here

# -----------------------------------------------------------------------------
# GitHub Integration
# -----------------------------------------------------------------------------
# GitHub Fine-grained Personal Access Token
# To create:
#   1. Go to: GitHub -> Settings -> Developer settings
#   2. -> Personal access tokens -> Fine-grained tokens
#   3. Click "Generate new token"
#   4. Set permissions:
#      - Contents: Read and write (for branches, file access)
#      - Issues: Read and write (for issue management)
#      - Pull requests: Read and write (for PR management)
#      - Metadata: Read-only (auto-selected)
#   5. Copy the token here (or add to Jenkins secrets as 'github-token')
GITHUB_TOKEN=github_pat_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# Enable/disable GitHub integration (default: true)
GITHUB_ENABLED=true

# GitHub MCP Server
# For Docker: use 'github-mcp' (container name on Docker network)
# For local development: use 'localhost' when running MCP server locally
GITHUB_MCP_HOST=github-mcp
GITHUB_MCP_PORT=8083

# Obsidian Vault Path (mounted volume)
# OBSIDIAN_VAULT_PATH=/data/obsidian

# -----------------------------------------------------------------------------
# Frontend Settings
# -----------------------------------------------------------------------------
NEXT_PUBLIC_API_URL=http://localhost:8000
